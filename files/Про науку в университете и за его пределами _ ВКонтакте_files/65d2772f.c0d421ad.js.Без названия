"use strict";(self.webpackChunkvkweb=self.webpackChunkvkweb||[]).push([[17394],{278451:(e,t,n)=>{function o(){return{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" viewBox="0 0 20 20"><path fill="currentColor" fill-rule="evenodd" d="M11.6 3.5H8.4c-1.14 0-1.91 0-2.5.05-.58.05-.85.13-1.03.22a2.5 2.5 0 0 0-1.1 1.1c-.09.18-.17.45-.22 1.03-.05.59-.05 1.35-.05 2.5v3.2c0 1.14 0 1.91.05 2.5.05.58.13.85.22 1.04a2.5 2.5 0 0 0 1.1 1.09c.18.09.45.17 1.03.22.59.05 1.36.05 2.5.05h3.2c1.14 0 1.91 0 2.5-.05.58-.05.85-.13 1.04-.22a2.5 2.5 0 0 0 1.09-1.1c.09-.18.17-.45.22-1.03.05-.59.05-1.36.05-2.5V8.4c0-1.14 0-1.91-.05-2.5a2.72 2.72 0 0 0-.22-1.03 2.5 2.5 0 0 0-1.1-1.1c-.18-.09-.45-.17-1.03-.22-.59-.05-1.36-.05-2.5-.05Zm-9.16.68C2 5.04 2 6.16 2 8.4v3.2c0 2.24 0 3.36.44 4.22a4 4 0 0 0 1.74 1.74c.86.44 1.98.44 4.22.44h3.2c2.24 0 3.36 0 4.22-.44a4 4 0 0 0 1.74-1.74c.44-.86.44-1.98.44-4.22V8.4c0-2.24 0-3.36-.44-4.22a4 4 0 0 0-1.74-1.74C14.96 2 13.84 2 11.6 2H8.4c-2.24 0-3.36 0-4.22.44a4 4 0 0 0-1.74 1.74ZM10 6a.75.75 0 0 1 .75.75v2.5h2.5a.75.75 0 0 1 0 1.5h-2.5v2.5a.75.75 0 0 1-1.5 0v-2.5h-2.5a.75.75 0 0 1 0-1.5h2.5v-2.5A.75.75 0 0 1 10 6Z" clip-rule="evenodd"/></svg>',name:"add_square_outline_20"}}n.d(t,{getIcon20AddSquareOutline:()=>o})},29456:(e,t,n)=>{function o(){return{icon:'<svg fill="none" height="20" viewBox="0 0 20 20" width="20" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor"><path d="M7 10.75c0-.41.34-.75.75-.75h4.5a.75.75 0 0 1 0 1.5h-4.5a.75.75 0 0 1-.75-.75z"/><path clip-rule="evenodd" d="M14.58 2H5.42c-.53 0-.98 0-1.34.03-.38.03-.74.1-1.08.27-.52.26-.94.68-1.2 1.2-.17.34-.24.7-.27 1.08-.03.36-.03.8-.03 1.34v.42c.02.13.05.3.14.48a1.25 1.25 0 0 0 1.02.67L3 7.5v4.98c0 .81 0 1.47.04 2 .05.55.14 1.03.37 1.47.36.7.93 1.28 1.64 1.64.44.23.92.32 1.47.37.53.04 1.19.04 2 .04h2.96c.81 0 1.47 0 2-.04a3.84 3.84 0 0 0 1.47-.37c.7-.36 1.28-.93 1.64-1.64.23-.44.32-.92.37-1.47.04-.53.04-1.19.04-2V7.5h.34c.13-.02.3-.05.48-.14a1.25 1.25 0 0 0 .67-1.02l.01-.37v-.05c0-.53 0-.98-.03-1.34-.03-.38-.1-.74-.27-1.08A2.75 2.75 0 0 0 17 2.3a2.8 2.8 0 0 0-1.08-.27C15.56 2 15.12 2 14.58 2zm.92 5.5h-11v4.95c0 .85 0 1.45.04 1.9.04.46.1.72.2.92.22.42.57.77.99.98.2.1.46.17.91.21.46.04 1.06.04 1.91.04h2.9c.85 0 1.45 0 1.9-.04.46-.04.72-.1.92-.2.42-.22.77-.57.98-.99.1-.2.17-.46.21-.91.04-.46.04-1.06.04-1.91zM17 6v-.05c0-.57 0-.96-.02-1.25a1.36 1.36 0 0 0-.12-.52 1.25 1.25 0 0 0-.54-.54c-.1-.05-.23-.1-.52-.12-.3-.02-.68-.02-1.25-.02h-9.1c-.57 0-.96 0-1.25.02-.29.03-.43.07-.52.12-.23.12-.42.3-.54.54-.05.1-.1.23-.12.52C3 5 3 5.38 3 5.95V6z" fill-rule="evenodd"/></g></svg>',name:"archive_outline_20"}}n.d(t,{getIcon20ArchiveOutline:()=>o})},606484:(e,t,n)=>{function o(){return{icon:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M10 18.5a8.5 8.5 0 1 0 0-17 8.5 8.5 0 0 0 0 17Zm4.4-3.05a7 7 0 0 1-9.84-9.84l9.83 9.84Zm1.05-1.06L5.61 4.55a7 7 0 0 1 9.84 9.84Z" fill="currentColor"/></svg>',name:"block_outline_20"}}n.d(t,{getIcon20BlockOutline:()=>o})},72834:(e,t,n)=>{function o(){return{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M6.84 4H2.75a.75.75 0 0 0 0 1.5h.55l.9 9.25c.05.52.1.96.16 1.31.06.37.16.71.35 1.03a2.9 2.9 0 0 0 1.25 1.13c.33.16.68.22 1.06.25.36.03.8.03 1.32.03h3.32c.53 0 .96 0 1.32-.03.38-.03.73-.1 1.06-.25a2.9 2.9 0 0 0 1.25-1.13c.19-.32.29-.66.35-1.03.06-.35.1-.79.16-1.31l.9-9.25h.55a.75.75 0 0 0 0-1.5h-4.09a3.25 3.25 0 0 0-6.32 0Zm1.58 0h3.16a1.75 1.75 0 0 0-3.16 0Zm6.78 1.5H4.8l.9 9.07c.05.56.08.94.13 1.23.05.28.1.42.17.52a1.4 1.4 0 0 0 .6.55c.1.04.25.08.53.1.3.03.68.03 1.24.03h3.26c.56 0 .94 0 1.23-.02.29-.03.43-.07.54-.11a1.4 1.4 0 0 0 .6-.55c.06-.1.11-.24.16-.52.05-.3.1-.67.15-1.23l.89-9.07Zm-2.89 2a.75.75 0 0 1 .69.81l-.5 6a.75.75 0 0 1-1.5-.12l.5-6a.75.75 0 0 1 .81-.69Zm-4.62 0a.75.75 0 0 1 .8.69l.5 6a.75.75 0 0 1-1.49.13l-.5-6a.75.75 0 0 1 .69-.82Z" clip-rule="evenodd"/></svg>',name:"delete_outline_20"}}n.d(t,{getIcon20DeleteOutline:()=>o})},63275:(e,t,n)=>{function o(){return{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 20 20"><path d="M3.5 10c0-3.21 2.87-6 6.75-6 .42 0 .8-.3.8-.75.01-.44-.38-.75-.8-.75C5.68 2.5 2 5.83 2 10a7 7 0 0 0 1.26 4c-.1.6-.47 1.52-1.12 2.73a1.2 1.2 0 0 0 1.1 1.77c1.9-.06 3.35-.51 4.35-1.4.85.27 1.74.4 2.66.4 4.57 0 8.25-3.33 8.25-7.5 0-.36-.03-.72-.08-1.07a.75.75 0 0 0-1.49.23c.05.28.07.56.07.84 0 3.21-2.87 6-6.75 6a7.58 7.58 0 0 1-2.22-.33l-.4-.12a.75.75 0 0 0-.72.15l-.31.28c-.57.5-1.48.88-2.9 1 .53-1.05.9-1.98 1.04-2.71l.05-.3a.75.75 0 0 0-.12-.57l-.17-.25a5.51 5.51 0 0 1-1-3.15ZM17 5.5a2.5 2.5 0 1 1-5 0 2.5 2.5 0 0 1 5 0Z"/></svg>',name:"message_unread_top_outline_20"}}n.d(t,{getIcon20MessageUnreadTopOutline:()=>o})},700936:(e,t,n)=>{function o(){return{icon:'<svg fill="none" height="20" viewBox="0 0 20 20" width="20" xmlns="http://www.w3.org/2000/svg"><path d="M4.89 3.55c.29-.29.76-.29 1.06 0L16.1 13.72a.75.75 0 0 1-1.06 1.06L13 12.73v2.53c0 .83-.7 1.4-1.46 1.4-.63 0-1.25-.23-1.72-.66L6.3 12.72h-1.5c-.94 0-1.79-.71-1.79-1.7V8.98c0-1 .85-1.71 1.78-1.71h1.5l.66-.6L4.9 4.6a.75.75 0 0 1 0-1.06zM8 7.74l-.92.84a.75.75 0 0 1-.5.2h-1.8c-.1 0-.18.03-.23.08a.17.17 0 0 0-.06.13V11c0 .04.02.09.06.13.05.05.13.08.22.08h1.8c.2 0 .37.07.51.2l3.75 3.48c.17.16.4.26.66.27v-3.94zm3.53-4.4c.75 0 1.46.57 1.46 1.4v1.94a.75.75 0 0 1-1.5 0V4.83c-.26.01-.49.11-.66.27l-.1.1A.75.75 0 0 1 9.7 4.1l.11-.1a2.53 2.53 0 0 1 1.72-.67z" fill="currentColor"/></svg>',name:"mute_outline_20"}}n.d(t,{getIcon20MuteOutline:()=>o})},700899:(e,t,n)=>{function o(){return{icon:'<svg fill="none" height="20" viewBox="0 0 20 20" width="20" xmlns="http://www.w3.org/2000/svg"><path clip-rule="evenodd" d="M5.5 8a4.5 4.5 0 0 1 9 0v1.67c0 .3.1.58.3.8l1.52 1.8a.75.75 0 0 1-.57 1.23H4.25a.75.75 0 0 1-.57-1.24l1.52-1.78c.2-.23.3-.52.3-.81V8zm-1.49-.39A6 6 0 0 1 16 7.75v1.82l1.46 1.72c1.25 1.46.21 3.71-1.7 3.71h-2.08a3.75 3.75 0 0 1-7.35 0H4.25a2.25 2.25 0 0 1-1.71-3.7L4 9.56V7.75l.01-.14zM10 16.5c-.98 0-1.81-.63-2.12-1.5h4.24c-.3.87-1.14 1.5-2.12 1.5z" fill="currentColor" fill-rule="evenodd"/></svg>',name:"notification_outline_20"}}n.d(t,{getIcon20NotificationOutline:()=>o})},726056:(e,t,n)=>{function o(){return{icon:'<svg width="20" height="20" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><g id="pin_outline_20__Icons" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="pin_outline_20__Icons-20/pin_outline_20"><g id="pin_outline_20__pin_outline_20"><path d="M0 0h20v20H0z"/><path d="M11.33 2.6a.75.75 0 0 1 1.27-.38l5.18 5.18a.75.75 0 0 1-.38 1.27l-1.54.3a.3.3 0 0 0-.15.09l-2.47 2.46a.3.3 0 0 0-.08.19l-.3 3.86a1.01 1.01 0 0 1-1.72.63L8 13.07l-4.72 4.71a.75.75 0 0 1-1.13-.98l.07-.08L6.93 12 3.8 8.87c-.37-.37-.4-.94-.09-1.34l.09-.1c.17-.17.4-.27.63-.29l3.86-.3a.3.3 0 0 0 .19-.08l2.46-2.46a.3.3 0 0 0 .08-.16Zm1.2 1.67-.03.17a1.8 1.8 0 0 1-.5.92L9.54 7.82c-.3.3-.7.49-1.13.52l-2.8.22 5.83 5.83.22-2.8c.03-.37.17-.73.41-1.01l.11-.12L14.64 8c.26-.25.58-.42.92-.5l.17-.03-3.2-3.2Z" id="pin_outline_20__Icon-Color" fill="currentColor" fill-rule="nonzero"/></g></g></g></svg>',name:"pin_outline_20"}}n.d(t,{getIcon20PinOutline:()=>o})},317343:(e,t,n)=>{function o(){return{icon:'<svg fill="none" height="20" viewBox="0 0 20 20" width="20" xmlns="http://www.w3.org/2000/svg"><g clip-rule="evenodd" fill="currentColor" fill-rule="evenodd"><path d="M17.96 8.15a.75.75 0 0 1-.57.52l-1.56.31a.25.25 0 0 0-.14.08c-.22.24-.45.47-.69.7a.75.75 0 0 1-1.06-1.06l.65-.66c.25-.27.58-.45.94-.53l.2-.04-3.2-3.2-.04.19c-.07.34-.23.65-.48.9l-.7.7A.75.75 0 0 1 10.23 5l.7-.7a.25.25 0 0 0 .08-.13l.3-1.56a.75.75 0 0 1 1.27-.39l5.19 5.18c.2.2.26.49.18.75zM8 13.06l3.14 3.14c.6.61 1.61.23 1.71-.58.09-.84.13-1.68.2-2.51l1.67 1.67a.75.75 0 1 0 1.06-1.06l-9.5-9.5a.75.75 0 1 0-1.06 1.06l1.67 1.67c-.85.07-1.72.08-2.56.2a1.01 1.01 0 0 0-.53 1.72L6.94 12l-4.8 4.8a.75.75 0 0 0 1.14.98zm3.44 1.33.21-2.68-3.37-3.37-2.67.22z"/></g></svg>',name:"pin_slash_outline_20"}}n.d(t,{getIcon20PinSlashOutline:()=>o})},466342:(e,t,n)=>{function o(){return{icon:'<svg fill="none" height="20" viewBox="0 0 20 20" width="20" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor"><path d="m10.75 11.56.97.97a.75.75 0 1 0 1.06-1.06l-2.25-2.25a.75.75 0 0 0-1.06 0l-2.25 2.25a.75.75 0 1 0 1.06 1.06l.97-.97v2.69a.75.75 0 0 0 1.5 0z"/><path clip-rule="evenodd" d="M14.58 2H5.42c-.53 0-.98 0-1.34.03-.38.03-.74.1-1.08.27-.52.26-.94.68-1.2 1.2-.17.34-.24.7-.27 1.08-.03.36-.03.8-.03 1.34v.42c.02.13.05.3.14.48a1.25 1.25 0 0 0 1.02.67L3 7.5v4.98c0 .81 0 1.47.04 2 .05.55.14 1.03.37 1.47.36.7.93 1.28 1.64 1.64.44.23.92.32 1.47.37.53.04 1.19.04 2 .04h2.96c.81 0 1.47 0 2-.04a3.84 3.84 0 0 0 1.47-.37c.7-.36 1.28-.93 1.64-1.64.23-.44.32-.92.37-1.47.04-.53.04-1.19.04-2V7.5h.34c.13-.02.3-.05.48-.14a1.25 1.25 0 0 0 .67-1.02l.01-.37v-.05c0-.53 0-.98-.03-1.34-.03-.38-.1-.74-.27-1.08A2.75 2.75 0 0 0 17 2.3a2.8 2.8 0 0 0-1.08-.27C15.56 2 15.12 2 14.58 2zm.92 5.5h-11v4.95c0 .85 0 1.45.04 1.9.04.46.1.72.2.92.22.42.57.77.99.98.2.1.46.17.91.21.46.04 1.06.04 1.91.04h2.9c.85 0 1.45 0 1.9-.04.46-.04.72-.1.92-.2.42-.22.77-.57.98-.99.1-.2.17-.46.21-.91.04-.46.04-1.06.04-1.91zM17 6v-.05c0-.57 0-.96-.02-1.25a1.36 1.36 0 0 0-.12-.52 1.25 1.25 0 0 0-.54-.54c-.1-.05-.23-.1-.52-.12-.3-.02-.68-.02-1.25-.02h-9.1c-.57 0-.96 0-1.25.02-.29.03-.43.07-.52.12-.23.12-.42.3-.54.54-.05.1-.1.23-.12.52C3 5 3 5.38 3 5.95V6z" fill-rule="evenodd"/></g></svg>',name:"unarchive_outline_20"}}n.d(t,{getIcon20UnarchiveOutline:()=>o})},689578:(e,t,n)=>{function o(){return{icon:'<svg fill="none" height="20" viewBox="0 0 20 20" width="20" xmlns="http://www.w3.org/2000/svg"><path d="M11.54 3.33c.75 0 1.46.58 1.46 1.41v10.52c0 .83-.7 1.4-1.46 1.4-.63 0-1.25-.23-1.72-.66L6.3 12.72h-1.5c-.94 0-1.79-.71-1.79-1.7V8.98c0-1 .85-1.71 1.78-1.71h1.5L9.83 4a2.53 2.53 0 0 1 1.72-.67zm-.04 1.5c-.26.01-.49.11-.66.27L7.1 8.58a.75.75 0 0 1-.5.2h-1.8c-.12 0-.29.07-.29.2v2.03c0 .14.17.21.28.21h1.8c.2 0 .37.07.51.2l3.75 3.48c.17.16.4.26.66.27zm6.12.4A6.76 6.76 0 0 1 19.67 10c0 1.84-.79 3.5-2.05 4.78a.75.75 0 1 1-1.07-1.06A5.26 5.26 0 0 0 18.17 10c0-1.4-.6-2.7-1.62-3.72a.75.75 0 1 1 1.07-1.06zm-2.13 2.54c.52.61.84 1.38.84 2.23 0 .85-.32 1.62-.84 2.23a.75.75 0 0 1-1.15-.96c.32-.38.5-.82.5-1.27 0-.45-.18-.89-.5-1.27a.75.75 0 0 1 1.15-.96z" fill="currentColor"/></svg>',name:"volume_outline_20"}}n.d(t,{getIcon20VolumeOutline:()=>o})},954293:(e,t,n)=>{n.d(t,{BUTTON_TYPE_OPEN_LINK:()=>b,BUTTON_TYPE_OPEN_MODAL_VIEW:()=>N,CALLBACK_TIMEOUT_MS:()=>G,getActionObjectFromElement:()=>j,getAttributesFromActionObject:()=>z,getButtonAppearance:()=>x,getButtonLabel:()=>Y,handleButtonClick:()=>V,handleCallbackAction:()=>B,handleOpenApp:()=>F,handleOpenLink:()=>y,handleShowSnackbar:()=>U,sendLocationFromKeyboard:()=>W});var o=n(912766),i=n(764646),a=n(659397),r=n(649638),s=n(397067),c=n(446735),l=n(261428),u=n(468706),_=n(862868),d=n(826918),g=n(689890),m=n(729747),p=n(944724),h=n(397974),v=n(354711),C=n(555694),f=n(712949),A=n(547142);const I=7131443,S="text",E="vkpay",L="location",T="open_app",b="open_link",N="open_modal_view",M="callback",k="default",w="secondary",O="primary",R=["app-id","owner-id","type","payload","hash","label","link"];function y(e,t){const n=new URL(e);if(!!n.hostname.match(f.OUR_DOMAINS))return void window.open(e);const o=new s.MessageBox;o.setOptions({title:i.getLang("mail_callback_popup_title"),bodyStyle:"overflow: hidden; text-overflow: ellipsis;"});const a=i.getLang("mail_callback_popup_text").replace("{name}",t).replace("{domain}",n.hostname);o.content(a),o.addButton(i.getLang("box_cancel"),!1,"no"),o.addButton(i.getLang("global_open"),(()=>{window.open((0,c.wrapAwayIfExternal)(e,!0)),o.hide()})),o.show()}function F({type:e,appId:t,ownerId:n,hash:o,appHash:i}){const a=e===E?I:t,s=n?"_"+n:"",c=o?encodeURIComponent("#"+o):"";(0,r.showWiki)({w:"app"+a+s+c,from_keyboard:1,app_hash:i})}function U({peerId:e,ownerId:t,text:n,store:o}){const i=(0,_.getTab)(o,e),a=(0,p.oCacheGet)(o,t),r=A.Ranges.isChatOrChannelPeer(e)&&a?a.photo:void 0;(0,d.showNotification)({text:n,title:i.name,photo:r})}const P=["open_link","open_modal_view","open_app"],H=2e3;function D(e){const t=setTimeout((()=>e.set(u.unsetActionCallbackTimeout)),H);e.set((e=>(0,u.setActionCallbackTimeout)(t,e)))}function B(e,t){const{action:n}=e,o=(0,m.getPeer)(t)===e.peer_id;if(!n||!o)return;if(!(P.includes(e.action.type)&&(0,m.getActionCallbackTimeout)(t)))switch(e.action.type){case"open_link":case"open_modal_view":!function({peerId:e,store:t,link:n}){y(n,(0,_.getTab)(t,e).name)}({peerId:e.peer_id,link:n.link,store:t}),D(t);break;case"open_app":F({type:n.type,appId:n.app_id,ownerId:n.owner_id,hash:n.hash,appHash:(0,m.getKeyboardAppHash)(t)}),D(t);break;case"show_snackbar":U({peerId:e.peer_id,ownerId:e.owner_id,text:n.text,title:n.title,store:t});break;default:return}}const G=6e4;function V(e,t,n,o){const{app_id:i,owner_id:a,type:r,payload:s,hash:c="",link:u=""}=e,{keyboardAuthorId:_}=o,d=(0,m.getKeyboardAppHash)(n);switch(r){case b:(0,m.getPeer)(n)===C.VK_OFFICIAL_PEER_ID&&(0,g.isOnboardingFindFriendsLink)(u)&&(0,h.collectOnboardingFindFriendsClickStats)((0,v.unpackStore)(n).viewer_id);break;case E:case T:F({type:r,appId:i,ownerId:a,hash:c,appHash:d});break;case L:W((e=>t({keyboardAuthorId:_,action:{label:"",attaches:[e],payload:s}})));break;case S:t({action:e,appHash:d,keyboardAuthorId:_});break;case M:var p,f;const{message:A,peerId:I,onBeforeSend:N=(()=>{}),onSendSuccess:k=(()=>{}),onSendFail:w=(()=>{})}=o;N(),(0,l.sendMessageEvent)({author_id:_,conversation_message_id:null==(p=A)?void 0:p.chat_local_id,message_id:null==(f=A)?void 0:f.messageId,peer_id:I,payload:e.payload}).then(k,w);break;default:e.payload=JSON.stringify({command:"not_supported_button",button_type:r,payload:e.payload}),t({action:e,appHash:d,keyboardAuthorId:_})}}function x(e){return K(e)?O:e.color.toLowerCase().replace(k,w)}function Y(e){const{type:t,label:n}=e.action;return t===L?i.getLang("mail_keyboard_label_location"):K(e)?i.getLang("mail_keyboard_label_vkpay").replace(/ VK Pay$/,""):function(e){let t=e;return t=(0,a.decodeHTMLEntities)(t||""),t=(0,o.clean)(t).replace(/\n(\r)?/gi," "),t=Emoji.emojiToHTML(t,!0),t}(n)}function K(e){const{type:t,app_id:n}=e.action;return t===E||t===T&&n===I}function j(e){return R.reduce(((t,n)=>(t[n.replace("-","_")]=e.getAttribute("data-"+n)||void 0,t)),{})}function z(e,t){let n=Object.entries(e).reduce(((e,[t,n])=>e+` data-${t.replace("_","-")}="${(0,o.clean)(""+n)}"`),"");if(e.type===b||e.type===N){n+=` href="${(0,c.wrapAwayIfExternal)(encodeURI(e.link),!0)}" target="_blank" rel="nofollow noopener"`}return n+=` data-index="${t}"`,n}function W(e){cur.sendLocation=function(t,n){n(),e(t)},(0,s.showBox)("al_places.php",{act:"a_choose_place_box",from_keyboard:1},{stat:["places.css","map.css","maps.js","ui_controls.css","ui_controls.js","boxes.css"],width:640,bodyStyle:"padding: 0px;"})}},665766:(e,t,n)=>{n.d(t,{addDelegateEvent:()=>s,removeDelegateEvent:()=>c});var o=n(538248),i=n(975969);let a=new window.Map;function r(e){let t=a.get(e.currentTarget);if(!t)return;let n,i=t[e.type];if(i)for(let t=0;t<i.length;t++){let a,[r,s]=i[t];if((0,o.hasClass)(e.target,r)?a=s(e,e.target):(n=(0,o.gpeByClass)(r,e.target,e.currentTarget))&&(a=s(e,n)),!1===a)break}}function s(e,t,n,o,s){let c=a.get(e);c||(a.set(e,{}),c=a.get(e));let l=t.split(" ");for(let t=0;t<l.length;t++){let a=l[t];c[a]||(c[a]=[],s?(0,i.addEvent)(e,a,r,!1,!1,s):(0,i.addEvent)(e,a,r)),c[a].push([n,o])}}function c(e,t,n,o){let s=a.get(e);if(!s)return;t.split(" ").forEach((t=>{s[t]&&(s[t]=s[t].filter((e=>e[0]!==n||e[1]!==o)),0===s[t].length&&(0,i.removeEvent)(e,t,r))}));0===Object.keys(s).map((e=>s[e].length)).reduce(((e,t)=>e+t))&&a.delete(e)}},116805:(e,t,n)=>{n.d(t,{createScroll:()=>l,getNativeOption:()=>a});var o=n(381702),i=n(314502);function a(e,t){return document.body[e]||document.documentElement[e]}class r{update(){}resize(){this.innerHeight=window.innerHeight}scrollTop(e){if(void 0===e)return a("scrollTop",this.el);!function(e,t,n){"scrollTop"===e&&window.scrollTo(0,t)}("scrollTop",e,this.el)}contHeight(){return a("scrollHeight")}smoothScroll(e){(0,i.scrollToY)(e+this.scrollTop(),300)}getContainer(){return this.el}getScroller(){return null}scrollBottom(e){if(void 0===e)return this.contHeight()-this.scrollTop()-this.getScrollHeight();let t=this.contHeight()-e-this.getScrollHeight();this.scrollTop(t)}scrollBottomFixSave(e){let t=Date.now();const n=()=>{Date.now()-t<500&&this.scrollBottom(e),window.removeEventListener("scroll",n)};window.addEventListener("scroll",n),this.scrollBottom(e)}onScroll(e){let t=this.scrollTop(),n=t-this.prevScroll,o=this.contHeight();this.opts.onScroll&&this.opts.onScroll(-n,this),this.opts.scrollChange&&this.opts.scrollChange(t),this.opts.more&&o-t<2*this.innerHeight&&this.opts.more(this),this.prevScroll=t}getScrollHeight(){return this.innerHeight}destroy(){(0,o.destroyModule)(this.module)}constructor(e,t){this.el=e,this.opts=t,this.module=(0,o.createModule)({handlers:(e,t)=>{e(window,"scroll",this.onScroll.bind(this)),e(window,"resize",this.resize.bind(this))}}),this.innerHeight=window.innerHeight,this.prevScroll=this.scrollTop()}}class s{update(){this.scroll.update("sync")}scrollTop(e){return void 0!==e?this.scroll.scrollTop(e):this.scroll.data.scrollTop}getContainer(){return this.scroll.content}getScroller(){return this.scroll.scroller}contHeight(){return this.scroll.data.scrollHeight}smoothScroll(e){this.scroll.scrollTop(this.scrollTop()+e,300)}scrollBottom(e){return void 0!==e?this.scroll.scrollBottom(e):this.scroll.data.scrollBottom}scrollBottomFixSave(e){let t=Date.now();this.scroll.emitter.addOnceListener("resize",(()=>{Date.now()-t<500&&this.scroll&&this.scrollBottom(e)})),this.scrollBottom(e)}getScrollHeight(){return this.scroll.data.viewportHeight}destroy(){this.scroll.destroy()}constructor(e,t){this.prevTop=0,this.scroll=new uiScroll(e,{hidden:void 0===t.hidden||t.hidden,shadows:t.shadows,stopScrollPropagation:!1,theme:t.scrollTheme,onmore:()=>t.more&&t.more(this),onscroll:e=>{const n=this.scrollTop(),o=this.prevTop-n;this.prevTop=n,t.scrollChange&&t.scrollChange(n),t.onScroll&&t.onScroll(o,this)}})}}class c{update(){}getContainer(){return this.el}getScroller(){return null}scrollTop(e){return 0}contHeight(){return 0}smoothScroll(e){}scrollBottom(e){return 0}scrollBottomFixSave(e){}getScrollHeight(){return 0}destroy(){}constructor(e,t){this.el=e}}function l(e,t){return t.noScroll?new c(e):t.nativeScroll?new r(e,t):new s(e,t)}},368596:(e,t,n)=>{n.d(t,{statlogsProbValueEvent:()=>r,statlogsValueEvent:()=>a});var o=n(414126),i=n(292218);function a(e,t,n,o,a){return(0,i.statlogsValueEvent)(e,t,n,o,a)}function r(e,t,n,i,r,s){(0,o.randEnabled)(e)&&a(t,n,i,r,s)}},182974:(e,t,n)=>{n.d(t,{customMetricsCollector:()=>i});var o=n(725927);const i=new class{logEvent(e){return this.actionStatCollector.logEvent({type:"type_ab_custom_metrics_item",type_ab_custom_metrics_item:e})}constructor(){this.productionStatCollector=new o.ProductionStatCollector,this.actionStatCollector=new o.ActionStatCollector(this.productionStatCollector)}}},681128:(e,t,n)=>{n.d(t,{messagingActionItemStatCollector:()=>i});var o=n(725927);const i=new class{logEvent(e){const t={type:"type_messaging_action_item",type_messaging_action_item:e};this.actionStatCollector.logEvent(t)}constructor(){this.productStatCollector=new o.ProductionStatCollector,this.actionStatCollector=new o.ActionStatCollector(this.productStatCollector)}}},369297:(e,t,n)=>{n.d(t,{audioMessageStatCollector:()=>i});var o=n(725927);const i=new class{logEvent(e){const t={type:"type_messaging_audio_message_item",type_messaging_audio_message_item:e};this.actionStatCollector.logEvent(t)}constructor(){this.productStatCollector=new o.ProductionStatCollector,this.actionStatCollector=new o.ActionStatCollector(this.productStatCollector)}}},176472:(e,t,n)=>{n.d(t,{ContactRecommendationCollector:()=>a});var o=n(216108),i=n(725927);const a=new class{logEvent(e){switch(e.event_type){case"click":{const t={type:"type_messaging_contact_recommendations_item",position:e.position,type_messaging_contact_recommendations_item:e},n={type:o.EventItemType.TYPE_MESSAGING_CONTACT_RECOMMENDATIONS_ITEM};return this.clickStatCollector.logEvent(t,n)}case"show":case"hide":{const t={type:"type_messaging_contact_recommendations_item",type_messaging_contact_recommendations_item:e};return this.actionStatCollector.logEvent(t)}}}constructor(){this.productionStatCollector=new i.ProductionStatCollector,this.clickStatCollector=new i.ClickStatCollector(this.productionStatCollector),this.actionStatCollector=new i.ActionStatCollector(this.productionStatCollector)}}},797635:(e,t,n)=>{n.d(t,{STICKERS_CONFDATA_KEY:()=>o,isNewStickerPicker:()=>a,isPromoVmojiCounterEnabled:()=>s,isUGCStickersEnabled:()=>r});var o,i=n(414126);function a(){return(0,i.partConfigEnabled)("new_sticker_picker")}function r(){return(0,i.partConfigEnabled)("stickers.ugc")}function s(){return(0,i.partConfigEnabled)("vmoji.promo.avatar_suggestion.promo_counter")}!function(e){e.UGC="stickers.ugc",e.PROMO_VMOJI_COUNTER="vmoji.promo.avatar_suggestion.promo_counter",e.NEW_STICKER_PICKER="new_sticker_picker"}(o||(o={}))},381702:(e,t,n)=>{n.d(t,{createModule:()=>r,createMutations:()=>a,destroyModule:()=>s});var o=n(665766),i=n(975969);function a(e){return{callMutations(){if("function"==typeof e)throw console.trace(),new Error("Mutations are not initialized");return e},bindMutations(...t){if("function"!=typeof e)throw console.trace(),new Error("Mutations are already initialized");return e=e(...t)}}}function r(e){const t={_registeredHandlers:[]};return e.handlers(((...e)=>function(e,t,n,o){(0,i.addEvent)(t,n,o),e._registeredHandlers.push({handlerType:"bind",elem:t,types:n,handler:o})}(t,...e)),((...e)=>function(e,t,n,i,a,r){(0,o.addDelegateEvent)(t,n,i,a,r),e._registeredHandlers.push({handlerType:"delegate",elem:t,types:n,selector:i,handler:a})}(t,...e))),t}function s(e){e._registeredHandlers.forEach((e=>{const{handlerType:t,elem:n,types:a,handler:r}=e;"delegate"===t?(0,o.removeDelegateEvent)(n,a,e.selector,r):(0,i.removeEvent)(n,a,r)})),e._registeredHandlers=[]}},212897:(e,t,n)=>{n.d(t,{Scroll:()=>c});var o=n(434788),i=n(820224),a=n(785893),r=n(853957),s=n(116805);const c=e=>{var{children:t}=e,n=(0,i._)(e,["children"]);return(0,a.jsx)(r.ScrollContext.Provider,{value:{createScroll:s.createScroll},children:(0,a.jsx)(r.Scroll,(0,o._)({},n,{children:t}))})};c.defaultProps={isNative:!1,isShadows:!1,neverHide:!1}},523411:(e,t,n)=>{n.d(t,{MAIL_CHAT_FLAG_ADMINS_CAN_ADD_ADMINS:()=>_,MAIL_CHAT_FLAG_DENY_ANYONE_TO_WRITE:()=>p,MAIL_CHAT_FLAG_IS_BUSINESS_NOTIFY:()=>m,MAIL_CHAT_FLAG_IS_CASPER:()=>h,MAIL_CHAT_FLAG_IS_COMMUNITY_CHAT:()=>v,MAIL_CHAT_FLAG_IS_COMMUNITY_CHAT_DELETED:()=>C,MAIL_CHAT_FLAG_IS_FAKE_CHANNEL:()=>g,MAIL_CHAT_FLAG_ONLY_ADMINS_CAN_CALL:()=>b,MAIL_CHAT_FLAG_ONLY_ADMINS_CAN_CHANGE_STYLE:()=>c,MAIL_CHAT_FLAG_ONLY_ADMINS_CAN_CHANGE_TITLE:()=>u,MAIL_CHAT_FLAG_ONLY_ADMINS_CAN_INVITE:()=>s,MAIL_CHAT_FLAG_ONLY_ADMINS_CAN_MASS_MENTION:()=>f,MAIL_CHAT_FLAG_ONLY_ADMINS_CAN_PIN:()=>l,MAIL_CHAT_FLAG_ONLY_ADMINS_CAN_SEE_INVITE_LINK:()=>L,MAIL_CHAT_FLAG_ONLY_OWNER_CAN_CALL:()=>N,MAIL_CHAT_FLAG_ONLY_OWNER_CAN_CHANGE_STYLE:()=>M,MAIL_CHAT_FLAG_ONLY_OWNER_CAN_CHANGE_TITLE:()=>S,MAIL_CHAT_FLAG_ONLY_OWNER_CAN_INVITE:()=>I,MAIL_CHAT_FLAG_ONLY_OWNER_CAN_MASS_MENTION:()=>A,MAIL_CHAT_FLAG_ONLY_OWNER_CAN_PIN:()=>E,MAIL_CHAT_FLAG_ONLY_OWNER_CAN_SEE_INVITE_LINK:()=>T,MAIL_CHAT_FLAG_SERVICE_CHAT:()=>d,canAddAdmin:()=>U,canChangeInviteLink:()=>F,canChangeTitle:()=>G,canCloseChat:()=>Y,canInviteUser:()=>P,canKickUser:()=>H,canMassMention:()=>y,canPinOrUnpin:()=>D,canSeeAllMessages:()=>V,canSeeInviteLink:()=>R,canSeeSettingsItem:()=>x,canStartGroupCall:()=>B,isUserAdminInChat:()=>j,isUserOwnerInChat:()=>z});var o=n(977041),i=n(862868),a=n(729747),r=n(547142);const s=1,c=2,l=4,u=8,_=16,d=64,g=1024,m=4096,p=16384,h=32768,v=1<<17,C=1<<18,f=1<<19,A=1<<20,I=1<<21,S=1<<22,E=1<<23,L=1<<24,T=1<<25,b=1<<26,N=1<<27,M=1<<31;var k;!function(e){e.SEE_INVITE_LINK="see_invite_link",e.CHANGE_INVITE_LINK="change_invite_link",e.INVITE_USER="invite_user",e.PIN_OR_UNPIN="pin_unpin",e.CHANGE_TITLE="change_title",e.ADD_ADMIN="add_admin",e.MASS_MENTION="mass_mention",e.START_GROUP_CALL="call",e.CHANGE_STYLE="change_style"}(k||(k={}));const w={change_invite_link:[32,32],add_admin:[_,_],see_invite_link:[L,T],invite_user:[s,I],pin_unpin:[l,E],change_title:[u,S],mass_mention:[f,A],call:[b,N],change_style:[c,M]},O=1;function R(e,t,n){return K(e,"see_invite_link",t,n)}function y(e,t,n){return K(e,"mass_mention",t,n)}function F(e,t,n){return K(e,"change_invite_link",t,n)}function U(e,t,n,a){const r=(0,o.unpackStore)(e),s=n||r.peer,c=(0,i.getTab)(r,s);return!(!c||!(0,i.isChatConvo)(c))&&(!z(c,t)&&K(e,"add_admin",s,a))}function P(e,t,n){return K(e,"invite_user",t,n)}function H(e,t,n,a){if(function(e,t){const n=(0,o.unpackStore)(e);return void 0!==n.service&&(n.service&t)>0}(e,O))return!0;const r=(0,o.unpackStore)(e),s=n||r.peer,c=void 0===a?r.viewer_id:a,l=r.gid,u=(0,i.getTab)(r,s);return!(!u||!(0,i.isChatConvoWithDetails)(u))&&(!(u.data.kicked&&!u.data.closed)&&(!(0,i.isChannelPeer)(u)&&(!z(u,t)&&(!!z(u,c)||(!(!l||!z(u,-l))||(j(u,c)||function(e,t){return e.invitedByMe.includes(t)}(u,t))&&!j(u,t))))))}function D(e,t,n){return K(e,"pin_unpin",t,n)}function B(e,t,n){return K(e,"call",t,n)}function G(e,t,n){return K(e,"change_title",t,n)}function V(e,t,n){const s=(0,o.unpackStore)(e),c=n||s.viewer_id,l=t||(0,a.getPeer)(e);if(!r.Ranges.isGroupId(c))return!0;const u=(0,i.getTab)(e,l);return!(!u||!(0,i.isChatConvoWithDetails)(u))&&!!u.caccess[c]}function x(e,t,n){const r=(0,o.unpackStore)(e),s=n||r.viewer_id,c=t||(0,a.getPeer)(e),l=(0,i.getTab)(e,c);if(!l||!(0,i.isChatConvoWithDetails)(l))return!1;const u=(0,i.isChannelPeer)(l);if(!(0,i.isCommunityChat)(l))return z(l,s)&&!u;const _=(0,i.isChatActive)(l),d=z(l,-r.gid)&&_||j(l,s)&&_,g=(l.allowedUpdateFlags||[]).filter((e=>e!==p));return d&&g.length>0}function Y(e,t,n){const r=(0,o.unpackStore)(e),s=n||r.viewer_id,c=t||(0,a.getPeer)(e),l=(0,i.getTab)(e,c);if(!l||!(0,i.isChatConvoWithDetails)(l))return!1;const u=(0,i.isCommunityChat)(l),_=(0,i.isCommunityChatDeleted)(l),d=(0,i.isChatActive)(l),g=z(l,-r.gid)&&d||j(l,s)&&d;return u&&!_&&g&&(l.allowedUpdateFlags||[]).includes(p)}function K(e,t,n,r){const s=(0,o.unpackStore)(e),c=(0,a.isCommunityInterface)(e)?s.id:s.viewer_id,l=void 0===r?c:r,u=void 0===n?s.peer:n,_=(0,i.getTab)(s,u);if(!_||!(0,i.isChatConvo)(_))return!1;const d=(0,i.isChatActive)(_),[g,m]=w[t],p=m|g,h=(0,i.isChannelPeer)(_),v=z(_,l)&&d,C=v||j(_,l)&&d;if(h)switch(t){case"add_admin":case"invite_user":return!1;case"see_invite_link":return d;default:return(0,a.isCommunityInterface)(s)}if((0,i.isCommunityChat)(_)){if((0,i.isClosedChat)(_))return!1;switch(t){case"see_invite_link":return(0,i.isServiceChatTab)(_)?d:(0,i.doesChatTabHaveFlag)(_,p)?(0,i.doesChatTabHaveFlag)(_,m)?d:C:v;case"change_invite_link":return v||C;case"add_admin":return(0,i.doesChatTabHaveFlag)(_,p)?C:v;case"mass_mention":case"call":return(0,i.isServiceChatTab)(_)?d:!v&&((0,i.doesChatTabHaveFlag)(_,p)?C:d);case"invite_user":var f,A;return(0,i.isServiceChatTab)(_)?d:!(v&&!_.isDonutChat)&&("chats"!==(null==(A=window.nav)||null==(f=A.objLoc)?void 0:f.act)&&((0,i.doesChatTabHaveFlag)(_,p)?C:d));case"pin_unpin":case"change_title":return(0,i.isServiceChatTab)(_)?d:C;default:return!1}}switch(t){case"change_invite_link":return(0,i.doesChatTabHaveFlag)(_,g)?C:v;case"add_admin":return(0,i.doesChatTabHaveFlag)(_,p)?C:v;case"see_invite_link":return(0,i.doesChatTabHaveFlag)(_,p)?(0,i.doesChatTabHaveFlag)(_,m)?d:C:v;case"invite_user":case"pin_unpin":case"mass_mention":case"call":case"change_title":return(0,i.doesChatTabHaveFlag)(_,p)?(0,i.doesChatTabHaveFlag)(_,g)?C:v:d}return!1}function j(e,t){return(e.adminIds||[]).includes(t)}function z(e,t){return e.ownerId===t}},862868:(e,t,n)=>{n.d(t,{canArchiveTab:()=>x,canBePinned:()=>$,doesChatTabHaveFlag:()=>y,getConvoInlineMenuActions:()=>Q,getConvoReactedPeerIds:()=>J,getCurrentTab:()=>L,getLocalSortId:()=>w,getPinnedMessage:()=>q,getRecommendedConvoList:()=>j,getTab:()=>p,getTabSafe:()=>E,hasUnreadReactionsBadge:()=>h,isBusinessNotifyPeer:()=>B,isBusinessNotifyTab:()=>D,isCasperChatTab:()=>H,isChannelPeer:()=>F,isChatActive:()=>Y,isChatConvo:()=>C,isChatConvoWithDetails:()=>I,isClosedChat:()=>G,isCommunityChat:()=>U,isCommunityChatDeleted:()=>P,isContactConvo:()=>A,isConvoBusinessNotifyEnabled:()=>W,isFullyLoadedTab:()=>m,isMutedConvo:()=>R,isPinnedMessageHidden:()=>K,isRecommendedConvo:()=>z,isServiceChatTab:()=>V,isTabMarkedUnread:()=>T,isUnreadWithExpiring:()=>ee,isUnreadWithMentions:()=>X,isUserConvo:()=>f,isUserEmptyScreenRich:()=>Z,isVKAgentPeer:()=>O,shouldUseReactionsShortPolling:()=>v,tabIsArchived:()=>k,tabIsBusinessNotification:()=>N,tabIsMessageRequest:()=>b,tabIsNotImportantMessageRequest:()=>M});var o=n(434788),i=n(977041),a=n(353654),r=n(729747),s=n(689890),c=n(523411),l=n(62435),u=n(537608),_=n(547142),d=n(296931),g=n(414126);function m(e,t){var n,o;const i=p(e,t);return!(void 0===(null==(n=i)?void 0:n.history)||!(null==(o=i)?void 0:o.msgs))}function p(e,t){const n=(0,i.unpackStore)(e);return n.tabs&&n.tabs[t]}function h(e,t){const n=p(e,t);if(!n)return!1;const o=(0,r.getUnreadReactions)(e,t);return!X(n)&&!ee(n)&&!!o.size}function v(e){return!!e.short_poll_reactions}function C(e){return _.Ranges.isChatOrChannelPeer(e.peerId)}function f(e){return _.Ranges.isUserIdTransitional(e.peerId)&&!_.Ranges.isContactId(e.peerId)}function A(e){return _.Ranges.isContactId(e.peerId)}function I(e){return _.Ranges.isChatOrChannelPeer(e.peerId)&&!!e.notifications}const S=0;function E(e,t){return p(e,void 0===t?S:t)}function L(e){return p(e,(0,r.getPeer)(e))}function T(e){return!!(e.folders&&e.folders&a.FOLDER_MASKS[a.FOLDER_MARKED_UNREAD])}function b(e){return Boolean(e.is_message_request||e.folders&&e.folders&a.FOLDER_MASKS[a.ConvoListFolder.MR]||e.folders&&e.folders&a.FOLDER_MASKS[a.FOLDER_MESSAGE_REQUEST_REJECTED])}function N(e){return!!(e.folders&&e.folders&a.FOLDER_MASKS[a.FOLDER_BUSINESS_NOTIFY])}function M(e){return Boolean(b(e)&&e.folders&&e.folders&a.FOLDER_MASKS[a.FOLDER_NOT_IMPORTANT_MESSAGE_REQUEST])}function k(e){return!!(e.folders&&e.folders&a.FOLDER_MASKS[a.FOLDER_ARCHIVE])}function w(e,t){const n=e.get().msg_local_ids_sort,o=n&&t.lastmsg&&n[t.lastmsg]||0;return o>0?2e9+o:t.minor_sort_id||0}function O(e){return 333==+e}function R(e,t){return!!e.mutedPeers&&e.mutedPeers.includes(t)}function y(e,t){return((e&&e.data&&e.data.flags||0)&t)>0}function F(e){return C(e)&&y(e,c.MAIL_CHAT_FLAG_IS_FAKE_CHANNEL)}function U(e){return C(e)&&y(e,c.MAIL_CHAT_FLAG_IS_COMMUNITY_CHAT)}function P(e){return C(e)&&y(e,c.MAIL_CHAT_FLAG_IS_COMMUNITY_CHAT_DELETED)}function H(e){return C(e)&&y(e,c.MAIL_CHAT_FLAG_IS_CASPER)}function D(e){return C(e)&&y(e,c.MAIL_CHAT_FLAG_IS_BUSINESS_NOTIFY)}function B(e,t){var n;return!!(null==(n=(0,i.unpackStore)(e).dialog_tabs[a.ConvoListFolder.BUSINESS_NOTIFY])?void 0:n.includes(t))}function G(e){return C(e)&&y(e,c.MAIL_CHAT_FLAG_DENY_ANYONE_TO_WRITE)}function V(e){return C(e)&&y(e,c.MAIL_CHAT_FLAG_SERVICE_CHAT)}function x(e){const t=!!e.offset||!!e.lastmsg;return!(100==+e.peerId||window.vk.id===e.peerId||_.Ranges.isContactId(e.peerId)||H(e))&&t&&!b(e)}function Y(e){return!e.data.closed&&!e.data.kicked}function K(e){const t=e.pinned&&(0,u.parseMessage)(e.pinned);return!!t&&e.pinHideId===t.chat_local_id}function j(e){return(0,i.unpackStore)(e).recommendationList}function z(e,t){const n=(0,i.unpackStore)(e).recommendationList;return Boolean(n&&n.item_data[t])}function W(e){return!!e.can_send_business_notify}function Z(e,t){const n=(0,i.unpackStore)(e),o=p(n,t);return _.Ranges.isUserIdTransitional(t)&&!_.Ranges.isContactId(t)&&!(0,l.isDialogWithYourself)(n.id,t)&&!(0,r.isCommunityInterface)(n)&&!(o&&function(e){return!!f(e)&&Boolean(e.is_deleted)}(o))}function q(e){return e&&C(e)&&e.pinned?(0,u.parseMessage)(e.pinned):null}function $(e,t){const n=(0,i.unpackStore)(e),o=!!t.offset||!!t.lastmsg;return!(0,r.isCommunityInterface)(n)&&o&&!H(t)&&!b(t)&&!k(t)}function Q(e,t){const n=(0,i.unpackStore)(e),c=n.active_tab,u=(0,l.getConvoInlineMenuActionData)(t,(0,r.isCommunityInterface)(e)),_=[];switch(c){case a.ConvoListFolder.ALL:case a.ConvoListFolder.UNREAD:case a.ConvoListFolder.ARCHIVE:x(t)&&_.push(k(t)?a.ConvoAction.UNARCHIVE:a.ConvoAction.ARCHIVE),$(e,t)&&_.push((0,s.isPinnedSortId)(t.major_sort_id||0)?a.ConvoAction.UNPIN_CONVO:a.ConvoAction.PIN_CONVO),_.push(R(n,t.peerId)?a.ConvoAction.UNMUTE:a.ConvoAction.MUTE),_.push(a.ConvoAction.CLEAR),C(t)&&Y(t)&&_.push(a.ConvoAction.LEAVE);break;case a.ConvoListFolder.BUSINESS_NOTIFY:_.push(R(n,t.peerId)?a.ConvoAction.UNMUTE:a.ConvoAction.MUTE),_.push(a.ConvoAction.LEAVE)}return _.map((e=>(0,o._)({},u[e],{action:e})))}function J(e,t){const n=(0,i.unpackStore)(e),o=n.tabs[t].msgs||{},a=Object.values(o).reduce(((e,o)=>{const i=Array.isArray(o)?o[8]:o.chat_local_id;return[...(0,d.getMessageReactedPeerIds)(n,t,i),...e]}),[]);return[...new Set(a)]}function X(e){return(0,g.partConfigEnabled)("me_web_read_by_cmid")?!(!e.mention_cmids||!e.mention_cmids.length):!(!e.mentions||!e.mentions.length)}function ee(e){return(0,g.partConfigEnabled)("me_web_read_by_cmid")?!(!e.expiring_cmids||!e.expiring_cmids.length):!(!e.expiring_messages||!e.expiring_messages.length)}},296931:(e,t,n)=>{n.d(t,{canMessageBeEdited:()=>Y,canSendReactions:()=>K,getLastMessage:()=>v,getLastMeta:()=>C,getLocalId:()=>f,getMessage:()=>d,getMessageAdminId:()=>L,getMessageByCmid:()=>g,getMessageReactedPeerIds:()=>X,getMessageReactions:()=>Q,getMessageTTL:()=>q,getMessageUserId:()=>E,getMyReaction:()=>J,getPreviousMessage:()=>S,hasForwards:()=>V,hasReply:()=>G,isActiveGroupCallMessage:()=>H,isAppAction:()=>b,isAudioMsg:()=>M,isCallMessage:()=>P,isCasperMessage:()=>F,isExistingRid:()=>h,isExpiredCasperMessage:()=>$,isGift:()=>w,isGraffiti:()=>N,isImportant:()=>x,isMessageEmpty:()=>Z,isMessageStored:()=>m,isMessageToBlockedCommunity:()=>W,isMessageWithUGCSticker:()=>ee,isMoney:()=>O,isMoneyRequest:()=>R,isNewStack:()=>z,isOutbound:()=>A,isServiceMsg:()=>I,isSticker:()=>k,isUnread:()=>D,isVKPay:()=>y,isVoiceMessageListened:()=>p,isWidgetMessage:()=>U,shiftDate:()=>j,wasEdited:()=>B});var o=n(532115),i=n(354711),a=n(862868),r=n(537608),s=n(379111),c=n(729747),l=n(824189),u=n(414126),_=n(196431);function d(e,t,n){var o,i;const s=null==(i=(0,a.getTab)(e,t))||null==(o=i.msgs)?void 0:o[n];return s?(0,r.parseMessage)(s):null}function g(e,t,n){var o;const i=(0,a.getTab)(e,t);if(!(null==(o=i)?void 0:o.msgs))return null;const s=Object.values(i.msgs).find((e=>(0,r.parseMessage)(e).chat_local_id===n));return s?(0,r.parseMessage)(s):null}function m(e,t,n){var o,i;return!!(null==(i=(0,a.getTab)(e,t))||null==(o=i.msgs)?void 0:o[n])}function p(e){return Boolean(e.flags&o.FLAG_AUDIO_MESSAGE_LISTENED)}function h(e,t,n){var o;const i=(0,a.getTab)(e,t);if(!(null==(o=i)?void 0:o.msgs))return!1;return!!Object.keys(i.msgs).find((o=>{var i;return(null==(i=d(e,t,+o))?void 0:i.randomId)===n}))}function v(e,t,n){const i=(0,a.getTab)(e,t);if(!i||!i.msgs)return;const s=n?d(e,t,n):void 0,c=Object.keys(e.msg_local_ids_sort||{}).length>1?Object.values(i.msgs).sort(((t,n)=>{const{messageId:o}=(0,r.parseMessage)(t),{messageId:i}=(0,r.parseMessage)(n);return f(e,o)-f(e,i)})):Object.values(i.msgs);if(!s)return(0,r.parseMessage)(c[c.length-1]);const l=s.local;for(let t=c.length-1;t>=0;t--){const n=(0,r.parseMessage)(c[t]),i=n.local&&n.type!==o.EDIT_MESSAGE;if(!l&&i)continue;if(l&&!i||f(e,s.messageId)>f(e,n.messageId))return n}}function C(e,t){var n;const o=null==(n=(0,a.getTab)(e,t))?void 0:n.lastmsg_meta;if(o)return Array.isArray(o)?(0,_.getMessageFromTuple)(o):o}function f(e,t){const n=(0,i.unpackStore)(e),o=n.msg_local_ids_sort&&n.msg_local_ids_sort[t];return void 0!==o?2e9+o:t}function A(e){return!!(e.flags&o.FLAG_OUTBOUND)}function I(e){return e.kludges&&void 0!==e.kludges.source_act}function S(e,t,n){const o=(0,a.getTab)(e,t);if(!o||!o.msgs)return null;const i=Object.keys(o.msgs).sort(((e,t)=>+e-+t));if(!i)return null;const r=i&&i.indexOf(""+n);if(-1===r)return null;return d(e,t,i[r-1])}function E(e,t){return A(t)?e.viewer_id:t.userId}function L(e,t){const n=(0,i.unpackStore)(e);return n.gid&&A(t)?Number(t.kludges.from_admin)||-n.gid:0}function T(e,t,n){const o=e.attaches[0];return!!o&&(o.type===t||void 0!==n&&o.type===n)}function b(e){return T(e,"app_action")}function N(e){return T(e,"doc")&&"graffiti"===e.attaches[0].kind}function M(e){return Boolean(e.attaches.find((e=>"doc"===e.type&&("audiomsg"===e.kind||"audio_message"===e.kind))))}function k(e){return Boolean(e.attaches.find((e=>"sticker"===e.type||"ugc_sticker"===e.type)))}function w(e){return T(e,"gift")}function O(e){return T(e,"money_transfer","money_request")}function R(e){return T(e,"money_request")}function y(e){return T(e,"link","vkpay")&&!!e.kludges.attach1_app_id&&6217559==e.kludges.attach1_app_id}function F(e){return Boolean(e.kludges.is_expired||e.kludges.expire_ttl||e.kludges.ttl&&e.flags&o.FLAG_DELETE_BY_TTL)}function U(e){var t;return null==(t=e.attaches)?void 0:t.some((e=>"widget"===e.type))}function P(e){return e.kludges&&e.kludges.attach1_type===s.AttachmentType.CALL}function H(e){return e&&e.attaches&&e.attaches[0]&&"group_call_in_progress"===e.attaches[0].type}function D(e,t){return"number"!=typeof t.messageId||((0,u.partConfigEnabled)("me_web_read_by_cmid")?A(t)?t.chat_local_id>(e.out_up_to_cmid||0):t.chat_local_id>(e.in_up_to_cmid||0):A(t)?t.messageId>(e.out_up_to||0):t.messageId>(e.in_up_to||0))}function B(e){return e.update_time>0}function G(e){const t=e.attaches.filter((e=>"mail"===e.type)).length>0;return!!(e.attaches.filter((e=>"reply"===e.type)).length>0||e.flags&o.FLAG_HAS_REPLY&&t)}function V(e){return e.attaches.some((e=>"mail"===e.type&&e.object.fwd_count>0))&&!(e.flags&o.FLAG_HAS_REPLY)}function x(e){return Boolean(e.flags&o.FLAG_IMPORTANT)}function Y(e,t){const n=(0,r.parseMessage)(t),o=(0,i.unpackStore)(e),s=(0,a.getTab)(o,n.peerId);if(s&&(0,a.isChatConvo)(s)&&!(0,a.isChatActive)(s))return!1;const c=o.viewer_id==n.peerId&&!o.gid,{messageEditAllowedTime:l,pinEditDelayTime:u,isPinEditEnabled:_}=o.pinMessageEditSettings,d=Date.now()/1e3,g=s&&(0,a.getPinnedMessage)(s),m=g&&g.messageId===n.messageId,p=n.kludges&&n.kludges.pinned_at,h=d-n.date>l,v=p&&d-p<u;if((0,a.isVKAgentPeer)(n.peerId))return!1;if(!c&&!A(n))return!1;if(I(n))return!1;if(w(n)||k(n)||M(n)||N(n)||O(n)||y(n)||P(n)||F(n)||function(e){return T(e,"widget")}(n)||b(n))return!1;if(function(e,t,n){const o=(0,i.unpackStore)(e),r=(0,a.getTab)(o,t);if(r){return(r.deleted||[]).includes(n)}return!1}(e,n.peerId,n.messageId))return!1;if(c)return!0;if(m&&h&&_){if(v)return!1}else if(h)return!1;return!0}function K(e,t){const n=(0,a.getTab)(e,t.peerId);return!(!n||!(0,u.partConfigEnabled)("messages_reactions")||(0,a.tabIsMessageRequest)(n)||(0,a.isChatConvo)(n)&&!(0,a.isChatActive)(n)||n.block_error&&n.block_error>0||(0,a.isContactConvo)(n))}function j(e,t){return 1e3*t+1e3*e.timeshift}function z(e,t,n,o,i=!1){if(E(o,t)!==E(o,n))return!0;const a=j(o,t.date),r=j(o,n.date);if(!(0,l.isSameDate)(a,r))return!0;if((0,c.isCommunityInterface)(o)&&Number(t.kludges.from_admin)!==Number(n.kludges.from_admin))return!0;if(n.date-t.date>300)return!0;if(I(t)||I(n))return!0;const s=F(t),u=F(n);if(s!==u)return!0;const _=t.kludges.is_expired,d=n.kludges.is_expired;if(s&&u&&_!==d)return!0;if(s&&u&&!_&&!d)return!0;if(s&&u&&_&&d)return!1;if(P(n)||P(t))return!0;if(H(n)||H(t))return!0;if(w(t)||w(n))return!0;if(N(t)||N(n))return!0;if(G(n))return!0;const g=!o.gid&&e.peerId===o.viewer_id;return!(D(e,t)===D(e,n)||!i||A(n)||g)}function W(e,t){return!(!e.blocked_community||!A(t))}function Z(e){return Number(e.messageId)<=0}function q(e){const t=e.kludges.ttl||e.kludges.expire_ttl;return t?Number(t):void 0}function $(e){return!(!e.kludges||!e.kludges.is_expired)}function Q(e,t,n){var o;return(null==(o=g(e,t,n))?void 0:o.kludges.reactions)||[]}function J(e,t,n){var o;return null==(o=g(e,t,n))?void 0:o.kludges.reaction_id}function X(e,t,n){var o,i;return(null==(i=g(e,t,n))||null==(o=i.kludges.reactions)?void 0:o.map((({user_ids:e})=>e||[])).flat())||[]}function ee(e,t){const n=d(e,(0,c.getPeer)(e),t);return!!n&&n.kludges.attach1_type===s.AttachmentType.UGC_STICKER}},944724:(e,t,n)=>{n.d(t,{oCacheExists:()=>i,oCacheGet:()=>a});var o=n(977041);function i(e,t){return t in(0,o.unpackStore)(e).oCache}function a(e,t){const n=(0,o.unpackStore)(e).oCache[t];return n&&!n._n&&(!function(e){if(!e.first_name){const t=e.name.split(" ",2);e.first_name=t[0],e.short_name=t[1]?t[0]+" "+t[1].substr(0,1)+".":t[0]}e.inv_name||(e.inv_name=e.name),e.kick_name||(e.kick_name=e.inv_name)}(n),n._n=1),n}},729747:(e,t,n)=>{n.d(t,{getActionCallbackTimeout:()=>I,getEmojiOptId:()=>E,getGroupId:()=>c,getKeyboardAppHash:()=>A,getLocalSettingsValue:()=>C,getPeer:()=>_,getPendingReadReactionsCmids:()=>p,getPressedButtonState:()=>f,getReactionData:()=>N,getTabCmidToMessageIdMap:()=>v,getUnreadCount:()=>d,getUnreadCountNotMuted:()=>g,getUnreadCountWithMuted:()=>m,getUnreadReactions:()=>h,isBusinessNotifyEnabled:()=>b,isClassicInterface:()=>L,isCommunityInterface:()=>l,isLastMsgDebugEnabled:()=>s,isRecommendationListRerenderNeeded:()=>S,isReversedConvoOrder:()=>u,isSearchView:()=>T});var o=n(977041),i=n(353654),a=n(547142),r=n(862868);function s(e){return(0,o.unpackStore)(e).isLastMsgFalseDebugger}function c(e){return(0,o.unpackStore)(e).gid}function l(e){return!!c(e)}function u(e){const t=(0,o.unpackStore)(e);return!!l(e)&&((19542789===t.gid||103416369===t.gid)&&(t.active_tab===i.ConvoListFolder.UNRESPOND||t.active_tab===i.ConvoListFolder.UNREAD))}function _(e){return(0,o.unpackStore)(e).peer}function d(e){const t=(0,o.unpackStore)(e);return t.settings.show_only_not_muted_messages?t.unread_counters.countNotMuted:t.unread_counters.count}function g(e){return(0,o.unpackStore)(e).unread_counters.countNotMuted}function m(e){return(0,o.unpackStore)(e).unread_counters.count}function p(e,t){var n;const i=(0,o.unpackStore)(e);if(a.Ranges.isZeroOwner(t))return new Set;return(null==(n=i.pendingReadReactionsCmids)?void 0:n.get(t))||new Set}function h(e,t){const n=(0,o.unpackStore)(e),i=(0,r.getTab)(n,t);if(a.Ranges.isZeroOwner(t)||!i)return new Set;const s=p(n,t),c=(i.unread_reaction_cmids||[]).filter((e=>!s.has(e)));return new Set(c)}function v(e,t){return(0,o.unpackStore)(e).cmidToMessageIdMap.get(t)||new Map}function C(e,t){return(0,o.unpackStore)(e).settings[t]}function f(e,t){const n=(0,o.unpackStore)(t),i=_(t),a=n.callbackEventButtons.get(i);return a?a.get(e):void 0}function A(e){return(0,o.unpackStore)(e).keyboard_app_hash}function I(e){return(0,o.unpackStore)(e).callbackActionTimeout}function S(e){return(0,o.unpackStore)(e).isRecommendationListRerenderNeeded}function E(e){return(0,o.unpackStore)(e).emojiOptId}function L(e){const t=(0,o.unpackStore)(e);return Boolean(t.gid||t.isClassic)}function T(e){const t=(0,o.unpackStore)(e);return Boolean(t.searchText||t.recentSearch)}function b(e){return!!(0,o.unpackStore)(e).isBusinessNotifyEnabled}function N(e,t){return(0,o.unpackStore)(e).reactions.get(t)}},468706:(e,t,n)=>{n.d(t,{addEmptyScreenUserInfo:()=>C,addToUnreadCounter:()=>_,setActionCallbackTimeout:()=>h,setChatList:()=>l,setLocalSettingsValue:()=>d,setMessageReactions:()=>f,setMyMessageReaction:()=>A,setPendingReadReactionsCmids:()=>g,setPressedCallbackButton:()=>m,setUnreadCounters:()=>u,unsetActionCallbackTimeout:()=>v,unsetPressedCallbackButton:()=>p,updateBlockStates:()=>c});var o=n(434788),i=n(353654),a=n(729747),r=n(296931),s=n(862868);function c(e,t){return t.block_states=(0,o._)({},t.block_states,e),Promise.resolve(t)}function l(e,t){return e.chatList=t,Promise.resolve(e)}function u(e,t){var n,o,r,s;const{count:c,countNotMuted:l,businessNotifyUnread:u=0,archiveUnreadCount:_,archiveUnreadUnmutedCount:d,archiveMentionsCount:g}=e;var m,p;return t.unread_counters={count:c,countNotMuted:l},t.dialog_tab_cts[i.ConvoListFolder.UNREAD]={total:(0,a.getUnreadCount)(t),unread:c,unreadNotMuted:l},t.dialog_tab_cts[i.ConvoListFolder.BUSINESS_NOTIFY]={total:Math.max(null!=(m=null==(o=t.dialog_tab_cts)||null==(n=o[i.ConvoListFolder.BUSINESS_NOTIFY])?void 0:n.total)?m:0,u),unread:u},t.dialog_tab_cts[i.ConvoListFolder.ARCHIVE]={total:Math.max(null!=(p=null==(s=t.dialog_tab_cts)||null==(r=s[i.ConvoListFolder.ARCHIVE])?void 0:r.total)?p:0,_),unread:_,unreadNotMuted:d,mentions:g},Promise.resolve(t)}function _(e,t,n){const o=Math.max(0,(0,a.getUnreadCountNotMuted)(n)+e),i=Math.max(0,(0,a.getUnreadCountWithMuted)(n)+e);return n.mutedPeers.includes(t)||(n.unread_counters.countNotMuted=o),n.unread_counters.count=i,Promise.resolve(n)}function d(e,t,n){return n.settings[e]=t,Promise.resolve(n)}function g(e,t,n){return t.length?n.pendingReadReactionsCmids.set(e,new Set(t)):n.pendingReadReactionsCmids.delete(e),Promise.resolve(n)}function m({peerId:e,eventId:t},n,o){o.callbackEventButtons.has(e)||o.callbackEventButtons.set(e,new Map);const i=o.callbackEventButtons.get(e);return i&&i.set(t,n),Promise.resolve(o)}function p({peerId:e,eventId:t},n){const o=n.callbackEventButtons?n.callbackEventButtons.get(e):void 0;if(!o)return Promise.resolve(n);const i=o.get(t);return i&&clearTimeout(i.timeout),o.delete(t),o.size||n.callbackEventButtons.delete(e),Promise.resolve(n)}function h(e,t){return t.callbackActionTimeout=e,Promise.resolve(t)}function v(e){return clearTimeout(e.callbackActionTimeout),e.callbackActionTimeout=void 0,Promise.resolve(e)}function C(e,t,n){var o,i,a;n.emptyScreenUserInfo||(n.emptyScreenUserInfo={});const[r,...s]=t;if(!r)return;const c=s.map((e=>({name:e.first_name||"",photo:e.photo})));n.emptyScreenUserInfo[e]={bdate:r.bdate,occupation:null==(o=r.occupation)?void 0:o.name,occupationType:null==(i=r.occupation)?void 0:i.type,city:null==(a=r.city)?void 0:a.title,commonCount:r.common_count,canWrite:r.can_write_private_message,mutualFriends:c}}function f(e,t,n,o){var i,a;const c=(0,r.getMessage)(e,t,n),l=(0,s.getTab)(e,t);if(!c||!(null==(i=l)?void 0:i.msgs))return Promise.resolve(e);const u=(null==(a=c.kludges.reactions)?void 0:a.map((e=>e.reaction_id)).reverse())||[];return o.sort(((e,t)=>u.indexOf(t.reaction_id)-u.indexOf(e.reaction_id))),c.kludges.reactions=o,l.msgs[n]=c,Promise.resolve(e)}function A(e,t,n,o){var i;const a=(0,r.getMessage)(e,t,n),c=(0,s.getTab)(e,t);return a&&(null==(i=c)?void 0:i.msgs)?(o?a.kludges.reaction_id=o:delete a.kludges.reaction_id,c.msgs[n]=a,Promise.resolve(e)):Promise.resolve(e)}},353654:(e,t,n)=>{n.d(t,{CONTROLLER:()=>a,ConvoAction:()=>S,ConvoListFolder:()=>c,FAVORITES_ICON_URL:()=>r,FOLDER_ALL:()=>l,FOLDER_ARCHIVE:()=>f,FOLDER_BUSINESS_NOTIFY:()=>C,FOLDER_IMPORTANT:()=>u,FOLDER_MARKED_UNREAD:()=>_,FOLDER_MASKS:()=>A,FOLDER_MESSAGE_REQUEST:()=>d,FOLDER_MESSAGE_REQUEST_REJECTED:()=>g,FOLDER_NOT_IMPORTANT_MESSAGE_REQUEST:()=>v,FOLDER_PEER_TAGS:()=>h,FOLDER_UNREAD:()=>m,FOLDER_UNRESPOND:()=>p,FolderAction:()=>E,MENTION_RAW:()=>i,SENDING_ICON_TIMEOUT:()=>s});var o=n(414126);const i=/(^|[\s.,:\'\";>\)\(])(\*|@)([A-Za-z0-9_\.]{2,32})\s*\((.+?)\)/g,a="al_im.php",r="/images/icons/im_favorites_100.png",s=2e3;var c;!function(e){e.ALL="all",e.IMPORTANT="important",e.MR="mr",e.UNREAD="unread",e.UNRESPOND="unrespond",e.AD_TAG="ad_tag",e.BUSINESS_NOTIFY="business_notify",e.ARCHIVE="archive",e.PEER_TAGS="custom_tag"}(c||(c={}));const l="all",u="important",_="marked_unread",d="mr",g="mr_rejected",m="unread",p="unrespond",h="custom_tag",v="mr_not_important",C="business_notify",f="archive",A={unrespond:2,important:1,mr:256,business_notify:8192,archive:1<<23,[g]:512,ad_tag:32768,[_]:1<<20};var I,S,E;(0,o.partConfigEnabled)("test_folder_masks")&&(A[v]=1<<22),function(e){e.USER="user",e.COMMUNITY="community",e.CHAT="chat",e.CHANNEL="channel",e.MR="mr",e.CHAT_MR="chat_mr",e.EMAIL="email",e.CONTACT="contact",e.BUSINESS_NOTIFY="business_notify"}(I||(I={})),function(e){e.SETTINGS="settings",e.BLOCK="block",e.CHAT_INVITE="chat_invite",e.USER_INVITE="user_invite",e.CREATE_CHAT="create_chat",e.MEDIA="media",e.SEARCH="search",e.PIN_HIDE="pin_hide",e.PIN_UNHIDE="pin_unhide",e.UNPIN="unpin",e.MUTE="mute",e.UNMUTE="unmute",e.CLEAR="clear",e.LEAVE="leave",e.RETURN="return",e.BLOCK_COMMUNITY="block_community",e.ALLOW_COMMUNITY="allow_community",e.BLOCK_NOTIFY="block_notify",e.CALL_AUDIO="call_audio",e.CALL_VIDEO="call_video",e.CALL_APP="call_app",e.UNREAD="unread",e.PIN_CONVO="pin_convo",e.UNPIN_CONVO="unpin_convo",e.CALL_BY_NAME="call_by_name",e.ENABLE_BUSINESS_NOTIFY="enable_business_notify",e.DISABLE_BUSINESS_NOTIFY="disable_business_notify",e.BUSINESS_NOTIFY="business_notify",e.ARCHIVE="archive",e.UNARCHIVE="unarchive",e.ADD_FRIEND="add_friend",e.BLOCK_USER="block_user",e.UNBLOCK_USER="unblock_user",e.REPORT_USER="report_user",e.CALL_FINISH="call_finish",e.REPORT_UGC_STICKER="report_ugc_sticker"}(S||(S={})),function(e){e.SHOW="show"}(E||(E={}))},62435:(e,t,n)=>{n.d(t,{getContactPeerId:()=>M,getConvoActionData:()=>F,getConvoInfoFromLocalIndex:()=>k,getConvoInlineMenuActionData:()=>U,getDataForChatMemberGrid:()=>O,getEmptyScreenUserInfo:()=>H,getFilterFnForConvoListFolder:()=>w,isDialogWithYourself:()=>P,mergeConvoLists:()=>T,normalizeTab:()=>N,normalizeTabsGotFromServer:()=>b,sortFn:()=>R});var o=n(434788),i=n(354711),a=n(862868),r=n(729747),s=n(646812),c=n(944724),l=n(353654),u=n(414126),_=n(764646),d=n(278451),g=n(29456),m=n(466342),p=n(63275),h=n(726056),v=n(317343),C=n(700936),f=n(689578),A=n(548632),I=n(72834),S=n(700899),E=n(606484),L=n(547142);function T(e,t,n){const o=e.reduce(((e,t)=>(e.set(t.peerId,!0),e)),new Map),i=n||(()=>!0);return[...e,...t.filter((e=>!o.has(e.peerId)&&i(e)))]}function b(e,t){for(let n in t)t.hasOwnProperty(n)&&N(e,t[n])}function N(e,t){var n;const i=(0,c.oCacheGet)(e,t.peerId),l=(0,a.getTab)(e,t.peerId),u=t.lastmsg;if(i&&(t.photo=t.photo||i.photo,t.name=t.name||i.name,t.href=t.href||i.link,t.sex=t.sex||i.sex),t.last_touched=(null==(n=l)?void 0:n.last_touched)||0,t.verified=!!t.verified,t.lastmsg=u||t.lastmsg_meta&&t.lastmsg_meta[0]||!1,(0,r.isLastMsgDebugEnabled)(e)&&(u||t.lastmsg_meta&&t.lastmsg_meta[0])&&!1===t.lastmsg&&(console.log((0,o._)({},t)),(0,s.showDebugAlert)()),t.folders=t.folders||null,t.unread=t.unread||0,t.online=t.online||0,t.is_new=!!t.is_new,t.out_up_to=null!=t.out_up_to?t.out_up_to:t.in_up_to||0,t.out_up_to_cmid=null!=t.out_up_to_cmid?t.out_up_to_cmid:t.in_up_to_cmid||0,L.Ranges.isUserIdTransitional(t.peerId)){var _,d;const e=t.last_seen;t.online=e&&(null==(_=e)?void 0:_.platform)||0,t.is_nft_photo=t.is_nft_photo||(null==(d=i)?void 0:d.is_nft_photo)||!1,t.last_seen=t.last_seen||{platform:0,time:0,mobile:0,can_see:0}}var g;L.Ranges.isChatOrChannelPeer(t.peerId)&&(t.memberIds=t.memberIds||(null==(g=l)?void 0:g.memberIds)||null);return t}function M(e){return e+19e8}function k(e){const t={peerId:e[0],name:e[1],tab:e[1],photo:e[2],href:e[3],online:e[4],is_friend:e[5],local_index:!0};return e[6]&&(t.data={flags:e[6]}),t}function w(e){switch(e){case l.ConvoListFolder.ALL:return e=>!(((0,u.partConfigEnabled)("simplified_start_conversation")?(0,a.tabIsNotImportantMessageRequest)(e):(0,a.tabIsMessageRequest)(e))||(0,a.tabIsBusinessNotification)(e)||(0,a.tabIsArchived)(e));case l.ConvoListFolder.UNREAD:return e=>!(0,a.tabIsMessageRequest)(e)&&!(0,a.tabIsBusinessNotification)(e)&&!(0,a.tabIsArchived)(e)&&(e.unread&&e.unread>0||(0,a.isTabMarkedUnread)(e));case l.ConvoListFolder.MR:return e=>(0,u.partConfigEnabled)("simplified_start_conversation")?(0,a.tabIsNotImportantMessageRequest)(e):(0,a.tabIsMessageRequest)(e);case l.ConvoListFolder.BUSINESS_NOTIFY:return a.tabIsBusinessNotification;case l.ConvoListFolder.ARCHIVE:return a.tabIsArchived;default:return t=>t.folders&&t.folders&l.FOLDER_MASKS[e]}}function O(e,t,n){const o=t.data.active.slice(0,4).map((t=>(0,c.oCacheGet)(e,t))).filter((e=>!!e));return[o.map((e=>e.photo)),n?o.map((e=>e.link)):[]]}function R(e,t,n){const o=t.lastmsg&&t.major_sort_id||0,i=n.lastmsg&&n.major_sort_id||0;let s=o!==i?i-o:(0,a.getLocalSortId)(e,n)-(0,a.getLocalSortId)(e,t);return(0,r.isReversedConvoOrder)(e)?-s:s}function y(e){return e.is_subscribed_to_me?_.getLang("mail_im_add_to_friends_accept"):e.is_subscribe_button?_.getLang("mail_follow_to_friend"):_.getLang("mail_im_add_to_friends")}function F(e,t){const n=(0,a.isChannelPeer)(e);return{[l.ConvoAction.SEARCH]:{icon:"search",name:_.getLang("mail_im_peer_search")},[l.ConvoAction.BLOCK_COMMUNITY]:{icon:"block",name:_.getLang("mail_block_comm_messages")},[l.ConvoAction.BLOCK_NOTIFY]:{icon:"block",name:_.getLang("mail_block_notify_messages")},[l.ConvoAction.ALLOW_COMMUNITY]:{icon:"unblock",name:_.getLang("mail_allow_comm_messages")},[l.ConvoAction.CLEAR]:{icon:"clear",name:L.Ranges.isEmailId(e.peerId)?_.getLang("mail_im_delete_email_contact"):_.getLang("mail_im_delete_all_history")},[l.ConvoAction.MUTE]:{icon:"mute",name:_.getLang("mail_im_mute")},[l.ConvoAction.PIN_CONVO]:{icon:"pin_convo",name:_.getLang("mail_pin_chat")},[l.ConvoAction.UNPIN_CONVO]:{icon:"unpin_convo",name:_.getLang("mail_unpin_chat")},[l.ConvoAction.UNMUTE]:{icon:"unmute",name:_.getLang("mail_im_unmute")},[l.ConvoAction.MEDIA]:{icon:"media",name:t?_.getLang("mail_im_show_media_history_group"):_.getLang("mail_im_show_media_history")},[l.ConvoAction.BLOCK]:{icon:"block",name:_.getLang("mail_block_user")},[l.ConvoAction.CHAT_INVITE]:{icon:"add",name:_.getLang("mail_im_create_chat_with")},[l.ConvoAction.USER_INVITE]:{icon:"invite",name:L.Ranges.isUserIdTransitional(e.peerId)&&1===e.canBeAddedToChat?_.getLang("mail_im_add_to_chat"):_.getLang("mail_im_invite_to_chat")},[l.ConvoAction.ADD_FRIEND]:{icon:e.is_subscribe_button?"subscribe_friend":"add_friend",name:y(e),iconHtml:e.is_subscribe_button?`<div class="ui_actions_menu_item_follow-icon">${(0,d.getIcon20AddSquareOutline)().icon}</div>`:""},[l.ConvoAction.CREATE_CHAT]:{icon:"invite",name:_.getLang("mail_im_create_chat_with")},[l.ConvoAction.LEAVE]:{icon:"leave",name:(0,a.isBusinessNotifyTab)(e)?_.getLang("mail_delete"):n?_.getLang("mail_leave_channel"):_.getLang("mail_leave_chat")},[l.ConvoAction.RETURN]:{icon:"return",name:n?_.getLang("mail_return_to_vkcomgroup"):_.getLang("mail_return_to_chat")},[l.ConvoAction.PIN_HIDE]:{icon:"pin_hide",name:_.getLang("mail_menu_pin_hide")},[l.ConvoAction.PIN_UNHIDE]:{icon:"pin_unhide",name:_.getLang("mail_menu_pin_show")},[l.ConvoAction.UNPIN]:{icon:"unpin",name:_.getLang("mail_menu_unpin")},[l.ConvoAction.SETTINGS]:{icon:"settings",name:n?_.getLang("mail_vkcomgroup_settings"):_.getLang("mail_settings")},[l.ConvoAction.CALL_AUDIO]:{icon:"call_audio",name:_.getLang("mail_im_call_audio")},[l.ConvoAction.CALL_VIDEO]:{icon:"call_video",name:_.getLang("mail_im_call_video")},[l.ConvoAction.CALL_APP]:{icon:"call_app",name:_.getLang("mail_im_call_app")},[l.ConvoAction.UNREAD]:{icon:"unread",name:_.getLang("mail_menu_mark_unread")},[l.ConvoAction.CALL_BY_NAME]:{icon:"call_by_name",name:_.getLang("mail_im_call_by_name")},[l.ConvoAction.ENABLE_BUSINESS_NOTIFY]:{icon:"notify",name:_.getLang("mail_im_enable_business_notify")},[l.ConvoAction.DISABLE_BUSINESS_NOTIFY]:{icon:"disable",name:_.getLang("mail_im_disable_business_notify")},[l.ConvoAction.ARCHIVE]:{icon:"archive",name:_.getLang("mail_im_archive")},[l.ConvoAction.UNARCHIVE]:{icon:"unarchive",name:_.getLang("mail_im_unarchive")},[l.ConvoAction.BUSINESS_NOTIFY]:{icon:"business_notify",name:_.getLang("mail_im_business_notify")},[l.ConvoAction.REPORT_USER]:{icon:"spam",name:_.getLang("mail_report_user")},[l.ConvoAction.BLOCK_USER]:{icon:"block",name:_.getLang("mail_block_user")},[l.ConvoAction.UNBLOCK_USER]:{icon:"unblacklist",name:_.getLang("mail_user_unblacklist")},[l.ConvoAction.CALL_FINISH]:{icon:"call_finish",name:_.getLang("calls_im_call_finish")},[l.ConvoAction.REPORT_UGC_STICKER]:{icon:"report",name:_.getLang("mail_im_report_ugc_sticker")}}}function U(e,t){const n=F(e,t);return[[l.ConvoAction.ARCHIVE,(0,g.getIcon20ArchiveOutline)().icon],[l.ConvoAction.UNARCHIVE,(0,m.getIcon20UnarchiveOutline)().icon],[l.ConvoAction.UNREAD,(0,p.getIcon20MessageUnreadTopOutline)().icon],[l.ConvoAction.PIN_CONVO,(0,h.getIcon20PinOutline)().icon],[l.ConvoAction.UNPIN_CONVO,(0,v.getIcon20PinSlashOutline)().icon],[l.ConvoAction.MUTE,(0,C.getIcon20MuteOutline)().icon],[l.ConvoAction.UNMUTE,(0,f.getIcon20VolumeOutline)().icon],[l.ConvoAction.LEAVE,(0,A.getIcon20Cancel)().icon],[l.ConvoAction.CLEAR,(0,I.getIcon20DeleteOutline)().icon],[l.ConvoAction.ENABLE_BUSINESS_NOTIFY,(0,S.getIcon20NotificationOutline)().icon],[l.ConvoAction.DISABLE_BUSINESS_NOTIFY,(0,E.getIcon20BlockOutline)().icon]].reduce(((e,[t,i])=>(e[t]=(0,o._)({},n[t],{icon:i}),e)),{})}function P(e,t){return(0,u.partConfigEnabled)("fav_dialog_with_yourself")&&e===t}function H(e,t){const n=(0,i.unpackStore)(e);return n.emptyScreenUserInfo&&n.emptyScreenUserInfo[t]}},537608:(e,t,n)=>{n.d(t,{parseMessage:()=>i});var o=n(196431);function i(e){return e&&Array.isArray(e)?(0,o.getMessageFromTuple)(e):e}},261428:(e,t,n)=>{n.d(t,{addFriend:()=>d,allowMessagesFromGroup:()=>v,archiveConversation:()=>f,banUser:()=>N,deleteFriend:()=>g,deleteReaction:()=>O,denyMessagesFromGroup:()=>h,forceCallFinish:()=>k,getByConversationMessageId:()=>S,getFriends:()=>l,getInfo:()=>s,getMembers:()=>u,getMessagesReactions:()=>L,getMutual:()=>m,getReactedPeers:()=>y,getUGCStickersInfo:()=>R,hideHelpHint:()=>b,hideSuggestedContact:()=>C,markAsListened:()=>T,markReactionsAsRead:()=>E,recogniseAudioMessage:()=>I,search:()=>_,sendMessageEvent:()=>c,sendReaction:()=>w,setInfo:()=>r,unarchiveConversation:()=>A,unbanUser:()=>M,usersGet:()=>p});var o=n(434788),i=n(87330),a=n(797635);function r(e,t){return(0,i.api)("account.setInfo",{name:e,value:t})}function s(){return(0,i.api)("account.getInfo",{})}function c(e){return(0,i.api)("messages.sendMessageEvent",e)}function l(e){return(0,i.api)("donut.getFriends",e)}function u(e){return(0,i.api)("groups.getMembers",e)}function _(e){return(0,i.api)("users.search",e)}function d(e){return(0,i.api)("friends.add",e)}function g(e){return(0,i.api)("friends.delete",e)}function m(e){return(0,i.api)("friends.getMutual",e)}function p(e){return(0,i.api)("users.get",e)}function h(e){return(0,i.api)("messages.denyMessagesFromGroup",e)}function v(e){return(0,i.api)("messages.allowMessagesFromGroup",e)}function C(e){return(0,i.api)("messages.hideSuggestedContact",e)}function f(e){return(0,i.api)("messages.archiveConversation",e)}function A(e){return(0,i.api)("messages.unarchiveConversation",e)}function I(e,t){return(0,i.api)("messages.recogniseAudioMessage",{message_id:e,audio_message_id:t})}function S(e,t,n){return(0,i.api)("messages.getByConversationMessageId",{conversation_message_ids:e.join(","),peer_id:t,group_id:n})}function E(e,t,n){return(0,i.api)("messages.markReactionsAsRead",{peer_id:t,group_id:n,cmids:e.join(",")})}function L(e,t,n){return(0,i.api)("messages.getMessagesReactions",{peer_id:e,cmids:t.join(","),group_id:n})}function T(e,t){return(0,i.api)("messages.markAsListened",{message_id:e,group_id:t})}function b(e){return(0,i.api)("account.hideHelpHint",{hint_id:e})}function N(e){return(0,i.api)("account.ban",{owner_id:e})}function M(e){return(0,i.api)("account.unban",{owner_id:e})}const k=e=>(0,i.api)("messages.forceCallFinish",{call_id:e}),w=(e,t,n,o)=>(0,i.api)("messages.sendReaction",{peer_id:e,reaction_id:n,group_id:o,cmid:t}),O=(e,t,n)=>(0,i.api)("messages.deleteReaction",{peer_id:e,group_id:n,cmid:t}),R=e=>(0,a.isUGCStickersEnabled)()?(0,i.api)("stickers.getUGCPackLists",{owner_ids:e}):Promise.resolve(),y=(e,t,n,a)=>(0,i.api)("messages.getReactedPeers",(0,o._)({peer_id:e,extended:1,fields:"photo_200, screen_name",group_id:t,cmid:n},a&&{reaction_id:a}))},826918:(e,t,n)=>{n.d(t,{showNotification:()=>i});var o=n(912766);function i({text:e,type:t,title:n,photo:i}){window.Notifier&&window.Notifier.showEvent({text:(0,o.clean)(e),type:t,title:n,author_photo:i})}},397974:(e,t,n)=>{n.d(t,{ConvoInviteEntryPoint:()=>o,collectChatCreateStats:()=>p,collectConversationSuggestionItemStats:()=>g,collectConvoInviteStats:()=>u,collectOnboardingFindFriendsClickStats:()=>d,collectOnboardingFindFriendsShowStats:()=>_,collectOpenMessageRequestStats:()=>m,collectVoiceStat:()=>h});var o,i=n(322917),a=n(182974),r=n(681128),s=n(176472),c=n(414126),l=n(369297);!function(e){e.DIALOG_ACTIONS="dialog_actions",e.PROFILE_SCREEN="profile_screen",e.CONTACT_SCREEN="contact_screen"}(o||(o={}));const u=(e,t)=>{(0,i.saveStatlogEvents)({name:"convo_invite",value:e,keys:[t]})},_=e=>{a.customMetricsCollector.logEvent({experiment_id:1285,service:"messages",metric_name:"open_vk_service_chat",metric_value:3,unit_id:e,unit_type_id:1})},d=e=>{a.customMetricsCollector.logEvent({experiment_id:1285,service:"messages",metric_name:"push_find_friends_button",metric_value:3,unit_id:e,unit_type_id:1})},g=(e,t,n)=>{s.ContactRecommendationCollector.logEvent({event_type:n,track_code:e,position:t})},m=e=>{r.messagingActionItemStatCollector.logEvent({peer_id:e,action_type:"OPEN_MR"})},p=(e,t,n)=>{(0,c.partConfigEnabled)("me_web_log_create_chat")&&r.messagingActionItemStatCollector.logEvent({peer_id:e,action_type:"CREATE_CHAT",entry_point:t,group_id:n})},h=(e,t,n,o,i,a)=>{l.audioMessageStatCollector.logEvent({action_type:e,peer_id:t,cmid:n,audio_message_id:o,action_source:"msg_list_attach",playback_rate:"play"===e?100:void 0,transcription_show:void 0!==i?i?1:0:void 0,actor:a})}},876609:(e,t,n)=>{n.d(t,{checkStopActionOnEventOnSticker:()=>d,checkStopActionOnEventOnStickerPopupIcon:()=>_,previewSticker:()=>s,showPackByClickOnSticker:()=>c,wrapSticker:()=>u});var o,i=n(797635),a=n(47928),r=n(292306);!function(e){e.MESSAGE="message"}(o||(o={}));const s=e=>window.Emoji.previewSticker(e,!1,{sticker_referrer:"message"}),c=(e,t)=>{var n;(0,i.isNewStickerPicker)()?null==(n=window.StickerPickerViewer)||n.api.getPack({productId:e}).then((n=>{var o,i;var a;Boolean(null==(i=n)||null==(o=i.product)?void 0:o.active)?null==(a=window.StickerPickerViewer)||a.showPack(e,t):s(e)})).catch((()=>{s(e)})):window.Emoji.getStickerPack(e).then((n=>{Boolean(n&&n[window.Emoji.PACK_FIELD_IS_ACTIVE])?window.Emoji.showPackInKeyboard(e,t):s(e)}))},l=e=>`Sticker--size${e}`,u=({stickerHtml:e,stickerWrapperClass:t="",icon:n,iconClass:o,size:i,iconTqAttrs:r})=>{const s=n?`<div class="Sticker__icon ${o}" ${r}>${n}</div>`:"";return`\n  <div class="${[a.STICKER_ROW_CLASS,t,l(i)].join(" ")}">\n    ${e}\n    ${s}\n  </div>  \n`},_=e=>{var t,n;return!!(null==(n=null==(t=e)?void 0:t.target)?void 0:n.closest("."+r.POPUP_STICKER_ICON_CLASS))},d=e=>{var t,n,o;const i=null==(t=e)?void 0:t.target;return!!(null==(n=i)?void 0:n.closest("."+a.STICKER_ROW_CLASS))||(!!(null==(o=i)?void 0:o.closest("."+r.POPUP_STICKER_WRAPPER_CLASS))||!!_(e))}},47928:(e,t,n)=>{var o;n.d(t,{REGULAR_SIZES:()=>a,SIZE_512:()=>i,STICKER_ROW_CLASS:()=>r,StickerSize:()=>o}),function(e){e[e.SMALL=128]="SMALL",e[e.MIDDLE=168]="MIDDLE",e[e.BIG=208]="BIG"}(o||(o={}));const i=512,a=[64,128,256,352,i],r="sticker_row"}}]);try{stManager.done("dist/web/chunks/65d2772f.c0d421ad.js")}catch(e){}